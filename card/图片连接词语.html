<script>


    function getRecentCards(d, c=3) {
        return [d, ["万全之策","ばんぜんのさく","準1級","まったく手ぬかりがないはかりごと。","『三国志』「魏志・劉表伝」より。「万全」は万に一つの失策もないという意味。","https://idiom-encyclopedia.com/wp-content/uploads/2019/05/wedding_couple-150x150.png",["万全之計（ばんぜんのけい）"],[],[],["万全之策で挑まないと失敗は許されないわよ。","わかっているよ。","健太くんにはもう後がないんだからね。","わかっているって。あんまり余計なプレッシャーをかけないでよ。"],["ともこちゃんの助言通り、万全之策でもしもの時の備えをしておいてよかったと思います。","健太くんは試験当日、寝坊をしないように、万全之策でともこちゃんに電話で7時に起こしてくれるよう頼んだおかげで起きることができました。","この目も当てられない結果を見ると、万全之策ではなかったということですよね。","万全之策で挑まないとエベレスト登頂はそんなに甘くない、命にかかわることになります。","面接対策は完ぺき、万全之策で当日を迎えたので、どんな質問が来ても的確に答えることができました。"],[],"",["g3.jpg","b1.jpg","g3.jpg","b1.jpg"]],["凋零磨滅","ちょうれいまめつ","準1級","しぼみ落ちて滅びること。文物などが滅びなくなることにいう。","『唐書』「芸文志・論」より。「凋」はしぼむ、「零」は落ちる、「磨滅」はすり減る、すり減りなくなるという意味。","https://idiom-encyclopedia.com/wp-content/uploads/2019/03/kids_hakusen-150x150.png",[],[],[],["ともこちゃん。何の作業をしているの？","貴重な文章の凋零磨滅を防ぐためにデジタル画像で保存して、永遠に後世に残すことができるようにしているのよ。","へえ。それは大事な作業だね。","そうなのよ。こうやってデジタル化することで文化財を管理保管することができ、複製を公開することができる大事な作業なのよ。"],["戦争の空襲でお城が焼失し凋零磨滅しました。","長い間大事にされてきた遺跡を凋零磨滅させないために、平和を保たなくてはいけません。","隣国に攻め込まれてから、この国は荒れ果て繁栄を誇った都とその文化は凋零磨滅しました。","凋零磨滅を防ぐために、文化の発展を推進します。","芸術の価値を理解しない人たちの手によって凋零磨滅させられました。"],[],"",["b3.jpg","g2.jpg","b3.jpg","g2.jpg"]],["阿世曲学","あせいきょくがく","準1級","学問の真理をまげて、世間や時勢に迎合すること。また、そうした人。","","https://idiom-encyclopedia.com/wp-content/uploads/2017/05/wakaremichi_man-1-150x150.png",["曲学阿世"],[],[],["今、戦時中の科学者についての本を読んでるの","難しい本読んでるんだね、おもしろい？","ためになるわ。当時はどの学者さんも阿世曲学じゃないと生きていけなかったんだって","今は自由にものが言えて、いい時代だよね。"],["昔の中国の学者は、皇帝の顔色をうかがって阿世曲学にならざるを得なかったそうだ。","阿世曲学にならないためにも、信念を持って研究にあたらなければならない。","このままでは、後の世から阿世曲学の非難を浴びることになる。","中にはプライドもなく、阿世曲学に走る不尊な学者がいるのも確かだ。","阿世曲学で今をごまかしても、いつか必ずボロがでる。"],["「曲学」は真理をまげた学問、「阿世」は世におもねる意。","truckleは「媚びへつらう」という意味の動詞。twistは「ねじる」という意味の動詞。\n英文例\nその学者が出した結論は阿世曲学だった。The conclusion that the scholar issued was truckling to the time and twisting the truth."],"",["g1.jpg","b3.jpg","g2.jpg","b2.jpg"]]];
    }

    function getHtml(data, index) {
        var html = g_order[index];
        for (var k of getStringToArray(html, '{{', '}}')) {
            switch (k) {
            case 'FrontSide':
                html = html.replace('{{' + k + '}}', getHtml(data, 0));
                break;

            default:
                var i = g_flds.indexOf(k);
                if (i != -1) {
                    var v = data[i];
                    if (i == 7) {
                        v = v.replace(/\|/g, "</br>");
                    }
                    if (v.indexOf('src') != -1) {
                        v = v.replace('src="', 'src="./res/' + g_uuid + '/');
                    }
                    html = html.replace('{{' + k + '}}', v);
                }
                break;
            }
        }
        return html;
    }

    function getStringToArray(str, s, e) {
        var i_start, i_end;
        var a_res = [];
        while (typeof (str) == 'string') {
            i_start = str.indexOf(s, i_end);
            if (i_start == -1)
                break;

            i_start += s.length;
            i_end = str.indexOf(e, i_start);
            if (i_end != -1) {
                a_res.push(str.substr(i_start, i_end - i_start));
                i_end += e.length;
            } else {
                i_end = i_start;
            }
        }
        return a_res;
    }
</script>
<head>
    <meta charset="utf-8">
     <link rel="stylesheet" type="text/css" href="../css/main.css">
    <link rel="stylesheet" type="text/css" href="../css/materialize.css">
    <link rel="stylesheet" type="text/css" href="../css/icon.css">
    <link rel="stylesheet" type="text/css" href="../css/x0popup.min.css">
    <link rel="stylesheet" type="text/css" href="../css/animate.min.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta http-equiv="Content-Security-Policy" content="block-all-mixed-content">
    <!-- 强制移动设备以app模式打开页面(即在移动设备下全屏，仅支持部分浏览器) -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-touch-fullscreen" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="full-screen" content="yes">
    <!--UC强制全屏-->
    <meta name="browsermode" content="application">
    <!--UC应用模式-->
    <meta name="x5-fullscreen" content="true">
    <!--QQ强制全屏-->
    <meta name="x5-page-mode" content="app">
    <!--QQ应用模式-->
    <meta name="description" content="List of drawing tutorials"/>
    <link rel="shortcut icon" href="favicon.ico">
    <title>Anki Web Test</title>
</head>
<style type="text/css">

    #_v_question_1 {
        overflow: hidden;
        padding-top: 10px;
    }

    #_v_question_1 img {
    	margin: 0px auto;
    	width: 150px;
    	height: 150px;
    	margin-bottom: 20px;
    }

    .bShadow-35, .bShadow-35h:hover {
        -webkit-box-shadow: rgba(26,26,67,0.05) 1px 1px 5px 0px, rgba(50,50,93,0.5) 39px 62.5px 125px -25px, rgba(0,0,0,0.3) 23.4px 37.5px 75px -37.5px;
        -moz-box-shadow: rgba(26,26,67,0.05) 1px 1px 5px 0px, rgba(50, 50, 93, 0.5) 39px 62.5px 125px -25px, rgba(0,0,0,0.3) 23.4px 37.5px 75px -37.5px;
        box-shadow: rgba(26,26,67,0.05) 1px 1px 5px 0px, rgba(50,50,93,0.5) 39px 62.5px 125px -25px, rgba(0,0,0,0.3) 23.4px 37.5px 75px -37.5px;
    }

    #_v_question_1 ._v_grid {
        padding-top: 7%;
        display: grid;
        grid-template-columns: 50% 50%;
    }

    #_v_question_1 .box {
        text-align: center;
        border: 1px solid #fefefe;
        position: relative;
        display: inline-block;
        width: calc(100% - 20px);
        box-shadow: 0 1px 2px rgba(0,0,0,0.15);
        margin: 0px auto;
        margin-bottom: 8px;
        cursor: pointer;
        -webkit-box-shadow: rgba(57,70,78,0.15) 0px 0px 1px 0px, rgba(57,70,78,0.25) 0px 20px 55px -8px;
        -moz-box-shadow: rgba(57,70,78,0.15) 0px 0px 1px 0px,rgba(57,70,78,0.25) 0px 20px 55px -8px;
        box-shadow: rgba(57,70,78,0.15) 0px 0px 1px 0px, rgba(57,70,78,0.25) 0px 20px 55px -8px;
    }

    #_v_question_1 .box span {
        font-size: 2.7em;
    }

    ._v_select {
        background-color: #bfbfbf !important;
    }

    ._v_green {
        background-color: #95c75b91 !important;
    }
    ._v_border {
    	border: 2px solid red;
    }
</style>
<script type="text/javascript" src='../js/jquery.min.js'></script>
<script type="text/javascript" src='../js/x0popup.min.js'></script>

<div class='_card'></div>
<script type="text/javascript">
    var d = ["阿鼻叫喚", "あびきょうかん", "準1級", "悲惨な状況に陥り、泣き叫び救いを求めるさまのたとえ。", "「阿鼻」は仏教でいう八大地獄のひとつ、阿鼻地獄のこと。「叫喚」はわめき叫ぶこと。阿鼻地獄に落ちた人々の泣き叫ぶさまからいう。", "https://idiom-encyclopedia.com/wp-content/uploads/2017/06/bg_hell_jigoku-150x150.jpg", ["叫喚地獄"], [], [], ["昨日のテスト、みんな出来が悪かったみたいね", "そうだよ、答案用紙が返って来る度にみんな阿鼻叫喚状態だったよ", "そうねぇ、日頃の努力が足りないから？", "ともこちゃんはいいよ、ひとりだけ９０点代だったんだから"], ["列車事故の現場は、まさに阿鼻叫喚の地獄絵図だった。", "金メダルを期待されていた選手が選外の結果になり、日本中が阿鼻叫喚だった。", "それは、阿鼻叫喚の中から、一筋の光が見えた瞬間だった。", "阿鼻叫喚の結果にならぬよう、我が塾は夏期講習をしっかりと行っていく。", "応援席の誰もが阿鼻叫喚を予感した時、その満塁ホームランが飛び出した。"], ["pandemoniumは「大混乱」や「修羅場」という意味の名詞。\n英文例\n事故現場は助ける人の声で阿鼻叫喚だった。 The Accident scene was in pandemonium with voice of people seeking help."], "", ["g1.jpg", "b1.jpg", "g1.jpg", "b1.jpg"]];
    var g_flds = ["yoji", "yomi", "level", "mean", "from", "image", "quasi", "antonym", "english", "usage", "example", "tips", "summary"];
    var g_uuid = 'img';
    var g_order = [`
<section id='_v_question_1'>
<div class='_v_grid up'></div>
<div class='_v_grid down'></div>
</section>
`];
    $('._card').html(getHtml(d, 0));
</script>
<script>
    var h = '';
    var _v_g_test = typeof(g_showing) == 'undefined';
    if(!_v_g_test){
        var d = g_showing;
    }else{
    	var g_showing = d;
    }
    var g_script = {
        "cards": getRecentCards(d, 3),
        'try': 0,
        'giveUp': false,
        'close': false,
        'time': new Date().getTime() / 1000,
        f_tip: function(){_tip(false)}
    };

    g_script.cards.sort(function() { return (0.1 - Math.random());});
   for (var card of g_script.cards) {
        h = h + "<img class='animated flipInX' animated='flipInX' d='"+card[3]+"' k='"+card[0]+"' src='"+card[5]+"'>";
    }
    $('._v_grid.up').html(h);

    g_script.cards.sort(function() { return (0.2 - Math.random());});
    h = '';
   for (var card of g_script.cards) {
        h = h + "<div class='box animated flipInX' animated='flipInX'><span>" +card[0] + "</span></div>";
    }
    $('._v_grid.down').html(h);

    function _check(){
    	var img = $('._v_border');
    	var box = $('._v_select');
    	if(img.length > 0 && box.length > 0){
    		img.removeClass('_v_border');
        	box.removeClass('_v_select');
    		if(img.attr('k') == box.find('span').text()){
    			img.attr('k', null);
    			_v_testAnim(img.attr('hide', 1), 'flipOutY');
                _v_testAnim(box.addClass('_v_green').attr('hide', 1), 'flipOutY');
    		}else{
    			  g_script.try++;
	            _v_testAnim(img, 'shake');
	            _v_testAnim(box, 'shake');
    		}
    	}
    }

    $('._v_grid img').click(function(event) {
        var el = $(this);
        if(!_v_g_test){
            TipMessage(4, el.attr('d'));
        }
        if(el.hasClass('_v_border')) return;
        if($('._v_border').length > 0){
        	$('._v_border').removeClass('_v_border');
        }
    	_v_testAnim(el.addClass('_v_border'), 'pulse');
        if($('._v_select').length > 0){
        	_check();
        }
    });

    $('._v_grid .box').click(function(event) {
        var el = $(this);
        if(el.hasClass('_v_green')) return;
        if($('._v_select').length > 0){
        	$('._v_select').removeClass('_v_select');
        }
    	_v_testAnim(el.addClass('_v_select'), 'pulse');
        if($('._v_border').length > 0){
        	_check();
        }
    });

    function _check_end(){
    	if($('img[k]').length===0){
            _v_end();
        }
    }

    function _v_testAnim(d, x) {
        if (d.attr('animated') != undefined) {
            d.removeClass(d.attr('animated'));
        }
        d.attr('animated', x).addClass(x);
        d.one('webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend', function() {
            if(d.attr('hide')) return _check_end();
            if (d.attr('animated') != undefined) {
                d.removeClass(d.attr('animated')).attr('animated', '');
            }
         });
    }

    function _v_beforeClose() {
        if(g_script.close == undefined) return;
         if(new Date().getTime() / 1000 - g_script.time > 2){
             x0p('Confirmation', 'Are you sure?', 'warning').then(function(data) {
                if(data.button == 'warning') {

                    g_script.close = undefined;
                    g_script.giveUp = true;
                    if(!_v_g_test) hideContent();
                    _tip(true);
                }
            });
         }
    }

    function _v_end(){
        // 如果小于60秒则算简单
        var score =  g_script.giveUp ? 0 : (new Date().getTime() / 1000 - g_script.time > 30 ? 1 : 2);
        g_script.close = undefined;
        if(!_v_g_test){
	        setTimeout(function() {
	        	chooseScore(score);
        	}, 1000);
	    }
    }

    function _tip(giveUp = false){
        $('._v_grid .box').each(function(index, el) {
             var box = $(this);
            if(box.hasClass('_v_green')) return true;
            var text = box.find('span').text();
        	$('._v_grid img').each(function(index, el) {
        		var img = $(this);
        		if(img.attr('k') == text){
                     if(giveUp){
                        var s = Math.random() > 0.5 ? 'fadeOutLeft' : 'fadeOutRight';
                        _v_testAnim(box.addClass('_v_green').attr('hide', 1), s);
                        _v_testAnim(img.attr('hide', 1), s);
                        setTimeout(function(){
                            _tip(giveUp);
                        }, 1000);
                    }else{
                        _v_testAnim(box, 'flash');
                        _v_testAnim(img, 'flash');
                    }
                    return false;
        		}
        	});
        	return false;
        });
    }

    if ($('._card').height() > $(this).height()) {
        $('._card').css('marginBottom', 100);
    }
</script>
<!-- 
<section><div id='level'></div><p><strong>【四字熟語】</strong><br>{{yoji}}</p><p><strong>【読み方】</strong><br>{{yomi}}<br></p><p><strong>【意味】</strong><br>{{mean}}</p><p><strong>【語源・由来】</strong><br>{{from}}</p><img class='cover'src='{{image}}'width=150 height=150><div id='usage'></div><div id='quasi'></div><div id='antonym'></div><div id='english'></div><div id='example'></div><div id='tips'></div><div id='summary'></div></section><script>var h='';var d=g_showing;if(d[2]!=''){$('._card #level').html(`<div class=\"level card\"><div class=\"header\"><span style=\"font-size: 40px\">`+d[2]+`</span></div><div class=\"container\"><p>日本漢字能力検定</p></div></div>`)}for(var i=0;i<d[9].length;i++){h=h+`<div class=\"chat `+(i % 2 === 0 ? 'r' : 'l')+`\"><div class=\"content\"><img width=\"40\"height=\"40\"src=\"res/`+g_uuid+`/`+d[13][i]+`\"class=\"img\"><div class=\"name\">`+(i%2===0?'健太':'ともに')+`</div><div class=\"message\">`+d[9][i].replace(d[0],'<span style=\"color: #ff0000;\"><strong>'+d[0]+'</strong></span>')+`</div></div></div>`}$('._card #usage').html(\"<div class='chat_content'>\"+h+'</div>');for(var i=6;i<12;i++){if(i==9||typeof(d[i])!=='object'||d[i].length==0)continue;var title=g_flds[i];switch(title){case'quasi':title='類義語';break;case'antonym':title='対義語';break;case'english':title='英語訳';break;case'example':title='例文';break;case'tips':title='ヒント';break;case'summary':title='まとめ';break}h=`<div class=\"text_card\"><div class=\"header\"><h1>`+d[0]+`（`+d[1]+`）の`+title+`</h1></div><div class=\"container\"><ol>`;for(var v of d[i]){h=h+`<li>`+v.replace(d[0],'<span style=\"color: #ff0000;\"><strong>'+d[0]+'</strong></span>')+`</li>`}$('._card #'+g_flds[i]).html(\"<div class='text_card'>\"+h+'</ol></div></div></div>')}</script>
 -->
